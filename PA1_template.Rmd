---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r}
library(data.table)
library(ggplot2)

## Load dataset and unzip it
url <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
download.file(url, destfile = paste(getwd(), "repdata.zip", sep = "/"), method = "curl")
unzip("repdata.zip")

## Read data. 
activityDT <- fread(input = "activity.csv")
```


## What is mean total number of steps taken per day?
#1. Calculate the total number of steps taken per day
```{r}
totalSteps <- aggregate(activityDT$steps, by=list(date=activityDT$date), FUN=sum)
```

#2.Make a histogram of the total number of steps taken each day
```{r}
hist(totalSteps$x,
     breaks=20,
     main="Histogram of Total Steps", 
     xlab="Steps")
````

#3. Calculate and report the mean and median of the total number of steps taken per day
```{r}
mean <- mean(totalSteps$x, na.rm = TRUE)
median <- median(totalSteps$x, na.rm = TRUE)
```
The mean total number of steps taken per day is ```{r mean} ``` and the median is ```{r median}.


## What is the average daily activity pattern?
#1. Make a time series plot (i.e. \color{red}{\verb|type = "l"|}type = "l") 
#   of the 5-minute interval (x-axis) and the average number of steps taken, 
#   averaged across all days (y-axis)
```{r}
intervalDT <- aggregate(activityDT$steps, by=list(interval=activityDT$interval), FUN=mean, na.rm=TRUE)
names(intervalDT)[2] <- "steps"

ggplot(intervalDT, aes(x = interval , y = steps)) + 
  geom_line(size=1) + 
  labs(title = "Average Daily Steps", x = "Interval", y = "Average Steps per day")
````

#2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r}
maxim <- intervalDT[intervalDT$steps == max(intervalDT$steps),]           
```
On average across all the days in the dataset, the 5-minute interval containing the maximum number of steps is ```{r maxim} ````


## Imputing missing values
# 1. Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with \color{red}{\verb|NA|}NAs)
nrow(activityDT[is.na(activityDT$steps),])
nrow

# 2. Devise a strategy for filling in all of the missing values in the dataset. 
```{r}
activityDT[is.na(steps), "steps"] <- activityDT[, c(lapply(.SD, median, na.rm = TRUE)), .SDcols = c("steps")]
head(activityDT)
```

# 3. Create a new dataset that is equal to the original dataset but with the missing data filled in.
fwrite(x = activityDT, file = "tidyData.csv", quote = FALSE)

# 4. Make a histogram of the total number of steps taken each day and 
# calculate and report the mean and median total number of steps taken per day. 
# Do these values differ from the estimates from the first part of the assignment? 
# What is the impact of imputing missing data on the estimates of the total daily number of steps?
totalSteps <- aggregate(activityDT$steps, by=list(date=activityDT$date), FUN=sum)
hist(totalSteps$x,
     breaks=20,
     main="Histogram of Total Steps", 
     xlab="Steps")

mean <- mean(totalSteps$x, na.rm = TRUE)
median <- median(totalSteps$x, na.rm = TRUE)

## Are there differences in activity patterns between weekdays and weekends?
